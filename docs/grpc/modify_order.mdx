---
title: "Modify Order"
description: "Updating an existing order via gRPC"
---

<Note>
  You can only modify orders by **`orderId`**. This is to prevent modifications
  of inflight orders. If you must modify an order before receiving an ACK,
  cancel the order and re-add it.
</Note>

## Example: Modifying an Order

<CodeGroup>
```python python
import grpc
import port_pb2
import port_pb2_grpc
import common_pb2

def modify_order():
metadata = (('api-key', API_KEY),)
channel = grpc.secure_channel('trade.pfex.io:443', grpc.ssl_channel_credentials())
stub = port_pb2_grpc.PortServiceStub(channel)

    def request_generator():
        # Modify an existing limit order
        yield port_pb2.OrdersStreamRequest(
            modify_order=port_pb2.ModifyOrderRequest(
                order_id="order-12345",
                symbol="SP500-USD",
                price=4210.00,
                size=2.0
            )
        )

    responses = stub.StreamOrders(request_generator(), metadata=metadata)
    for resp in responses:
        print("Response:", resp)

if **name** == '**main**':
modify_order()

````
```java java
import io.grpc.ManagedChannel;
import io.grpc.ManagedChannelBuilder;
import io.grpc.Metadata;
import io.grpc.stub.MetadataUtils;
import io.grpc.stub.StreamObserver;
import port.PortServiceGrpc;
import port.OrdersStreamRequest;
import port.OrderResponse;
import port.ModifyOrderRequest;

public class ModifyOrderExample {
    public static void main(String[] args) throws InterruptedException {
        ManagedChannel channel = ManagedChannelBuilder.forAddress("trade.pfex.io", 443)
            .useTransportSecurity()
            .build();

        Metadata metadata = new Metadata();
        metadata.put(Metadata.Key.of("api-key", Metadata.ASCII_STRING_MARSHALLER), API_KEY);

        PortServiceGrpc.PortServiceStub stub = PortServiceGrpc.newStub(channel)
            .withInterceptors(MetadataUtils.newAttachHeadersInterceptor(metadata));

        StreamObserver<OrdersStreamRequest> reqObs = stub.streamOrders(
            new StreamObserver<OrderResponse>() {
                @Override
                public void onNext(OrderResponse resp) {
                    System.out.println("Received: " + resp);
                }
                @Override
                public void onError(Throwable t) {
                    t.printStackTrace();
                }
                @Override
                public void onCompleted() {
                    System.out.println("Stream completed");
                }
            }
        );

        // Send modify order request
        ModifyOrderRequest mod = ModifyOrderRequest.newBuilder()
            .setOrder_id("abc12345-12345-12345-12345")
            .setSymbol("SP500-USD")
            .setPrice(4210.00)
            .setQuantity(2.0)
            .build();
        reqObs.onNext(
            OrdersStreamRequest.newBuilder().setModifyOrder(mod).build()
        );

        reqObs.onCompleted();
        Thread.sleep(500);
        channel.shutdown();
    }
}
````

```go go
package main

import (
    "context"
    "fmt"
    "io"
    "log"

    "google.golang.org/grpc"
    "google.golang.org/grpc/credentials"
    "google.golang.org/grpc/metadata"
    pb "path/to/proto/port"
)

func main() {
    creds := credentials.NewClientTLSFromCert(nil, "")
    conn, err := grpc.Dial("trade.pfex.io:443", grpc.WithTransportCredentials(creds))
    if err != nil {
        log.Fatalf("did not connect: %v", err)
    }
    defer conn.Close()

    client := pb.NewPortServiceClient(conn)
    ctx := metadata.AppendToOutgoingContext(context.Background(), "api-key", API_KEY)

    stream, err := client.StreamOrders(ctx)
    if err != nil {
        log.Fatalf("error on StreamOrders: %v", err)
    }

    // Send modify order
    stream.Send(&pb.OrdersStreamRequest{
        ModifyOrder: &pb.ModifyOrderRequest{
            OrderId: "abc12345-12345-12345-12345",
            Symbol:  "SP500-USD",
            Price:   4210.00,
            Size:    2,
        },
    })
    stream.CloseSend()

    // Receive response
    for {
        resp, err := stream.Recv()
        if err == io.EOF {
            break
        }
        fmt.Println("Response:", resp)
    }
}
```

```javascript node
const grpc = require("@grpc/grpc-js");
const protoLoader = require("@grpc/proto-loader");

const portDef = protoLoader.loadSync("port.proto", {
  keepCase: true,
  longs: String,
  enums: String,
  defaults: true,
  oneofs: true,
});
const portProto = grpc.loadPackageDefinition(portDef).port;

function modifyOrder() {
  const client = new portProto.PortService(
    "trade.pfex.io:443",
    grpc.credentials.createSsl()
  );

  const metadata = new grpc.Metadata();
  metadata.add("api-key", API_KEY);

  const call = client.streamOrders(metadata);

  call.on("data", (resp) => console.log("Response:", resp));
  call.on("end", () => console.log("Stream ended"));

  // Modify an order by orderId
  call.write({
    modifyOrder: {
      order_id: "abc12345-12345-12345-12345",
      symbol: "SP500-USD",
      price: 4210.0,
      size: 2,
    },
  });

  call.end();
}

modifyOrder();
```

</CodeGroup>

### [Example Response](https://github.com/QFEX-org/proto/blob/main/port.proto#L47)

```proto
order_id: "e486bf5b-15cb-49e5-848c-8eb29f295f0f"
symbol: "SP500-USD"
status: MODIFIED
quantity: 0.2
price: 560.6
update_time {
  seconds: 1746908577
  nanos: 126561133
}
user_id: "abc12345-6e54-48c4-82e9-641e64bf185d"
client_order_id: "order-id-123"
quantity_remaining: 0.2
```
